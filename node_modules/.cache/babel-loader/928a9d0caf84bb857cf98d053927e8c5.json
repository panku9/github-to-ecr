{"ast":null,"code":"import _asyncToGenerator from\"/var/www/html/ecs-repo/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _regeneratorRuntime from\"/var/www/html/ecs-repo/node_modules/@babel/runtime/regenerator/index.js\";import axios from\"axios\";import apis from\"../../services/Apis\";import{ActionTypes}from\"../constants/action-types\";import Auth from\"../../services/Auth\";import Alert from\"../../services/alert\";import{Navigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";export var loginUser=function loginUser(details){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch,getState){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.post(apis.BASE+apis.LOGIN,details);case 2:response=_context.sent;if(!response.data.success){_context.next=8;break;}Auth.storeToken(response.data.token);dispatch({type:ActionTypes.LOGIN,payload:{isLoggedIn:true,userDetails:response.data.admin}});_context.next=10;break;case 8:Auth.deleteToken();return _context.abrupt(\"return\",Alert('error','invalid data',response.data.message));case 10:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();};export var getAdminDetails=function getAdminDetails(){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:axios.get(apis.BASE+apis.GET_ADMIN_DETAILS,{headers:{'Authorization':\"Bearer \".concat(Auth.retriveToken())}}).then(function(response){if(response.data.success){dispatch({type:ActionTypes.LOGIN,payload:{isLoggedIn:true,userDetails:response.data.user}});}else{Auth.deleteToken();return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}}).catch(function(err){console.log(err);Auth.deleteToken();return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref2.apply(this,arguments);};}();};export var logoutUser=function logoutUser(){return function(dispatch){Auth.deleteToken();dispatch({type:ActionTypes.LOGOUT,payload:'Manual Logout'});};};","map":{"version":3,"sources":["/var/www/html/ecs-repo/src/redux/actions/loginAction.js"],"names":["axios","apis","ActionTypes","Auth","Alert","Navigate","loginUser","details","dispatch","getState","post","BASE","LOGIN","response","data","success","storeToken","token","type","payload","isLoggedIn","userDetails","admin","deleteToken","message","getAdminDetails","get","GET_ADMIN_DETAILS","headers","retriveToken","then","user","catch","err","console","log","logoutUser","LOGOUT"],"mappings":"2NAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,IAAP,KAAiB,qBAAjB,CACA,OAASC,WAAT,KAA4B,2BAA5B,CACA,MAAOC,CAAAA,IAAP,KAAiB,qBAAjB,CACA,MAAOC,CAAAA,KAAP,KAAkB,sBAAlB,CACA,OAASC,QAAT,KAAyB,kBAAzB,C,2CAEA,MAAO,IAAMC,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAACC,OAAD,CAAa,CACpC,+FAAO,iBAAMC,QAAN,CAAgBC,QAAhB,qJACkBT,CAAAA,KAAK,CAACU,IAAN,CAAWT,IAAI,CAACU,IAAL,CAAWV,IAAI,CAACW,KAA3B,CAAiCL,OAAjC,CADlB,QACCM,QADD,mBAEFA,QAAQ,CAACC,IAAT,CAAcC,OAFZ,yBAGHZ,IAAI,CAACa,UAAL,CAAgBH,QAAQ,CAACC,IAAT,CAAcG,KAA9B,EACAT,QAAQ,CAAE,CACRU,IAAI,CAAEhB,WAAW,CAACU,KADV,CAERO,OAAO,CAAG,CACRC,UAAU,CAAG,IADL,CAERC,WAAW,CAAGR,QAAQ,CAACC,IAAT,CAAcQ,KAFpB,CAFF,CAAF,CAAR,CAJG,8BAYHnB,IAAI,CAACoB,WAAL,GAZG,gCAaInB,KAAK,CAAC,OAAD,CAAS,cAAT,CAAwBS,QAAQ,CAACC,IAAT,CAAcU,OAAtC,CAbT,yDAAP,mEAgBD,CAjBM,CAmBP,MAAO,IAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CACnC,gGAAO,kBAAMjB,QAAN,sHACLR,KAAK,CAAC0B,GAAN,CAAUzB,IAAI,CAACU,IAAL,CAAUV,IAAI,CAAC0B,iBAAzB,CAA4C,CAC1CC,OAAO,CAAC,CACN,iCAA0BzB,IAAI,CAAC0B,YAAL,EAA1B,CADM,CADkC,CAA5C,EAIGC,IAJH,CAIQ,SAAAjB,QAAQ,CAAI,CAEhB,GAAGA,QAAQ,CAACC,IAAT,CAAcC,OAAjB,CAA0B,CACxBP,QAAQ,CAAC,CACPU,IAAI,CAAChB,WAAW,CAACU,KADV,CAEPO,OAAO,CAAE,CACPC,UAAU,CAAG,IADN,CAEPC,WAAW,CAAGR,QAAQ,CAACC,IAAT,CAAciB,IAFrB,CAFF,CAAD,CAAR,CAOD,CARD,IAQO,CACL5B,IAAI,CAACoB,WAAL,GACA,mBAAQ,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAR,CACD,CAEJ,CAnBD,EAmBGS,KAnBH,CAmBS,SAAAC,GAAG,CAAI,CACdC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACA9B,IAAI,CAACoB,WAAL,GACA,mBAAQ,KAAC,QAAD,EAAU,EAAE,CAAC,GAAb,EAAR,CACD,CAvBD,EADK,wDAAP,iEA2BD,CA5BM,CA8BP,MAAO,IAAMa,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,SAAK,UAAA5B,QAAQ,CAAG,CACxCL,IAAI,CAACoB,WAAL,GACAf,QAAQ,CAAC,CACNU,IAAI,CAAGhB,WAAW,CAACmC,MADb,CAENlB,OAAO,CAAG,eAFJ,CAAD,CAAR,CAID,CANyB,EAAnB","sourcesContent":["import axios from \"axios\"\nimport apis from \"../../services/Apis\";\nimport { ActionTypes } from \"../constants/action-types\";\nimport Auth from \"../../services/Auth\";\nimport Alert from \"../../services/alert\";\nimport { Navigate } from \"react-router-dom\";\n\nexport const loginUser = (details) => {\n  return async(dispatch, getState) => {\n    const response = await axios.post(apis.BASE+ apis.LOGIN,details);\n    if(response.data.success) {\n      Auth.storeToken(response.data.token);\n      dispatch( {\n        type: ActionTypes.LOGIN,\n        payload : {\n          isLoggedIn : true,\n          userDetails : response.data.admin\n        }\n      })\n    } else {\n      Auth.deleteToken();\n      return Alert('error','invalid data',response.data.message);\n    }\n  }\n}\n\nexport const getAdminDetails = () => {\n  return async(dispatch) => {\n    axios.get(apis.BASE+apis.GET_ADMIN_DETAILS, {\n      headers:{\n        'Authorization':`Bearer ${Auth.retriveToken()}`\n      }\n    }).then(response => {\n      \n        if(response.data.success) {\n          dispatch({\n            type:ActionTypes.LOGIN,\n            payload: {\n              isLoggedIn : true,\n              userDetails : response.data.user\n            }\n          })\n        } else {\n          Auth.deleteToken();\n          return (<Navigate to=\"/\"/>);\n        }\n      \n    }).catch(err => {\n      console.log(err);\n      Auth.deleteToken();\n      return (<Navigate to=\"/\"/>);\n    })\n    \n  }\n}\n\nexport const logoutUser = ()=> dispatch =>{\n  Auth.deleteToken();\n  dispatch({\n     type : ActionTypes.LOGOUT,\n     payload : 'Manual Logout'\n  })\n}"]},"metadata":{},"sourceType":"module"}